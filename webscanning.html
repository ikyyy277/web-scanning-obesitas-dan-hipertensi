<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>VISCERA â€“ Multimodal Health Screening</title>
<style>
body { font-family: Arial; background:#f3f6fb; }
.container {
  width:480px; background:white; margin:30px auto;
  padding:20px; border-radius:12px;
}
label { display:block; margin-top:10px; }
input, button {
  width:100%; padding:8px; margin-top:5px;
}
button { background:#004cff; color:white; border:none; cursor:pointer; }
.result {
  background:#eef3ff; padding:12px; margin-top:15px;
  border-radius:10px;
}
video { width:100%; margin-top:10px; border-radius:10px; }
small { color:#555; }
.error { color:red; font-weight:bold; }
</style>
</head>

<body>
<div class="container">
<h2>VISCERA</h2>
<small>Skrining Risiko Kardiometabolik Berbasis Multimodal (Non-Diagnostik)</small>

<label>Umur (18â€“80 tahun)</label>
<input id="umur">

<label>Berat Badan (kg)</label>
<input id="bb">

<label>Tinggi Badan (cm)</label>
<input id="tb">

<label>Denyut Nadi / menit</label>
<input id="nadi">

<label>Keluhan</label>
<input id="keluhan" placeholder="pusing, lelah, nyeri dada">

<button onclick="analisisManual()">Analisis Data Manual</button>
<div id="manualResult" class="result"></div>

<hr>

<button onclick="startCamera()">Aktifkan Kamera</button>
<video id="video" autoplay></video>

<button onclick="scanVisual()">Analisis Wajah & Tubuh</button>
<div id="finalResult" class="result"></div>
</div>

<script>
let manualScore = 0;
let bmiGlobal = 0;

function analisisManual(){
  let umur = parseInt(umurEl.value);
  let bb = parseFloat(bbEl.value);
  let tb = parseFloat(tbEl.value);
  let nadi = parseInt(nadiEl.value);
  let keluhan = keluhanEl.value.toLowerCase();

  if (umur<18||umur>80||bb<35||bb>150||tb<140||tb>200||nadi<50||nadi>120){
    manualResult.innerHTML = "<span class='error'>Input berada di luar batas fisiologis wajar.</span>";
    return;
  }

  bmiGlobal = bb / Math.pow(tb/100,2);
  manualScore = 0;

  if (umur >= 45) manualScore++;
  if (bmiGlobal >= 25) manualScore += 2;
  if (nadi > 90) manualScore += 2;
  if (keluhan.includes("pusing")||keluhan.includes("lelah")||keluhan.includes("sesak")) manualScore++;

  manualResult.innerHTML =
    "<b>Hasil Manual</b><br>" +
    "BMI: " + bmiGlobal.toFixed(1) + "<br>" +
    "Skor Risiko Manual: " + manualScore +
    "<br><small>Lanjutkan ke analisis visual.</small>";
}

function startCamera(){
  navigator.mediaDevices.getUserMedia({ video:true })
    .then(stream => video.srcObject = stream);
}

function scanVisual(){
  // SIMULASI NILAI INDIKATOR VISUAL
  let pipi = Math.random();
  let mata = Math.random();
  let simetri = Math.random();
  let rppg = Math.random();
  let body = Math.random();

  let faceScore = 0;
  let narasi = "<b>Analisis Visual</b><br>";

  // ðŸŸ¥ Pipi & wajah tengah
  if (pipi > 0.6){
    narasi += "â€¢ Pipi dan wajah bagian tengah menunjukkan intensitas kemerahan serta variasi warna yang fluktuatif, mengindikasikan aktivitas sirkulasi darah perifer yang meningkat.<br>";
    faceScore += 2;
  } else {
    narasi += "â€¢ Pola sirkulasi wajah bagian tengah berada dalam kisaran normal.<br>";
  }

  // ðŸ‘ï¸ Area bawah mata
  if (mata > 0.6){
    narasi += "â€¢ Area bawah mata tampak lebih gelap dengan tekstur pembuluh mikro menonjol, yang dapat berkorelasi dengan kelelahan sistemik dan stres fisiologis.<br>";
    faceScore += 1;
  } else {
    narasi += "â€¢ Area bawah mata tidak menunjukkan indikasi kelelahan visual signifikan.<br>";
  }

  // ðŸ˜ Simetri wajah & tegangan
  if (simetri > 0.6){
    narasi += "â€¢ Terdapat ketidaksimetrisan mikro wajah dan ketegangan rahang ringan, yang sering dikaitkan dengan aktivasi stres otonom kronis.<br>";
    faceScore += 1;
  } else {
    narasi += "â€¢ Simetri wajah dan relaksasi otot berada dalam kondisi wajar.<br>";
  }

  // â¤ï¸ rPPG
  if (rppg > 0.6){
    narasi += "â€¢ Estimasi denyut jantung visual menunjukkan nilai relatif tinggi saat istirahat, yang dapat mengindikasikan peningkatan beban kerja jantung.<br>";
    faceScore += 2;
  } else {
    narasi += "â€¢ Estimasi denyut jantung visual berada dalam rentang normal.<br>";
  }

  // ðŸ“ Body scan
  let bodyScore = 0;
  if (body > 0.6){
    narasi += "â€¢ Analisis proporsi tubuh mengindikasikan distribusi lemak sentral yang meningkat, yang merupakan faktor risiko utama penyakit kardiometabolik.<br>";
    bodyScore = 2;
  } else {
    narasi += "â€¢ Distribusi proporsi tubuh berada dalam batas normal.<br>";
  }

  let total = manualScore + faceScore + bodyScore;
  let level = "Rendah";
  if (total >= 8) level = "Tinggi";
  else if (total >= 4) level = "Sedang";

  let confidence = Math.min(95, 50 + total*5);

  finalResult.innerHTML =
    narasi +
    "<br><b>Risk Confidence Score:</b> " + total +
    "<br><b>Kategori Risiko:</b> " + level +
    "<br><b>Tingkat Keyakinan Sistem:</b> " + confidence + "%" +
    "<br><br><small>Hasil ini merupakan estimasi risiko berbasis penggabungan data fisiologis dan indikator visual non-invasif, bukan diagnosis medis.</small>";
}

const umurEl = document.getElementById("umur");
const bbEl = document.getElementById("bb");
const tbEl = document.getElementById("tb");
const nadiEl = document.getElementById("nadi");
const keluhanEl = document.getElementById("keluhan");
</script>

</body>
</html>
